# 通信设备规则配置
meta:
  name: communication_rules
  version: "1.0"
  category: communication
  applies_to:
    - switch
    - router
    - wireless
    - firewall

global:
  priorities:
    P0: "must_fix"
    P1: "risk_notice"
    P2: "suggest_improve"

fields:
  - group_id: basic
    group_label_cn: "基础信息"
    items:
      - field_id: purpose.use_case
        label_cn: "应用场景"
        priority: P1
        required_for: ["all"]
        type: "text"
        keywords_cn: ["用途", "应用场景", "网络环境", "用于"]
        validation:
          not_empty: true
          message_cn: "需明确设备用途和网络环境"

      - field_id: hardware.type
        label_cn: "设备类型"
        priority: P0
        required_for: ["all"]
        type: "enum"
        keywords_cn: ["交换机", "路由器", "无线AP", "防火墙", "网关"]
        enums:
          - "switch"
          - "router"
          - "wireless_ap"
          - "firewall"
          - "gateway"
        validation:
          message_cn: "需明确设备类型"

      - field_id: delivery.quantity
        label_cn: "数量"
        priority: P0
        required_for: ["all"]
        type: "integer"
        keywords_cn: ["数量", "台数", "套数"]
        validation:
          min_value: 1
          message_cn: "数量为必填项"

  - group_id: performance
    group_label_cn: "性能指标"
    items:
      - field_id: network.port_count
        label_cn: "端口数量"
        priority: P0
        required_for: ["switch", "router"]
        type: "integer"
        keywords_cn: ["端口数", "网口数", "接口数", "口数"]
        validation:
          min_value: 1
          message_cn: "端口数量为必填项"

      - field_id: network.port_speed
        label_cn: "端口速率"
        priority: P0
        required_for: ["switch", "router"]
        type: "text"
        keywords_cn: ["端口速率", "千兆", "万兆", "25G", "40G", "100G", "GbE"]
        validation:
          not_empty: true
          message_cn: "端口速率为必填项"

      - field_id: network.throughput
        label_cn: "吞吐量"
        priority: P1
        required_for: ["firewall", "router"]
        type: "text"
        keywords_cn: ["吞吐量", "转发能力", "包转发率", "bps", "pps"]
        validation:
          message_cn: "建议明确吞吐量要求"

      - field_id: network.backplane_bandwidth
        label_cn: "背板带宽"
        priority: P2
        required_for: ["switch"]
        type: "text"
        keywords_cn: ["背板带宽", "交换容量"]
        validation:
          message_cn: "建议明确背板带宽"

      - field_id: network.concurrent_connections
        label_cn: "并发连接数"
        priority: P1
        required_for: ["firewall"]
        type: "integer"
        keywords_cn: ["并发连接数", "连接数", "会话数"]
        validation:
          message_cn: "建议明确并发连接数要求"

  - group_id: wireless_specs
    group_label_cn: "无线规格"
    items:
      - field_id: wireless.frequency_band
        label_cn: "工作频段"
        priority: P0
        required_for: ["wireless"]
        type: "text"
        keywords_cn: ["频段", "2.4G", "5G", "6G", "双频", "三频"]
        validation:
          not_empty: true
          message_cn: "工作频段为必填项"

      - field_id: wireless.standard
        label_cn: "无线标准"
        priority: P1
        required_for: ["wireless"]
        type: "text"
        keywords_cn: ["WiFi", "802.11", "WiFi6", "WiFi7", "WiFi5", "ax", "ac", "n"]
        validation:
          message_cn: "建议明确无线标准"

      - field_id: wireless.tx_power
        label_cn: "发射功率"
        priority: P2
        required_for: ["wireless"]
        type: "text"
        keywords_cn: ["发射功率", "功率", "dBm"]
        validation:
          message_cn: "建议明确发射功率"

      - field_id: wireless.coverage
        label_cn: "覆盖范围"
        priority: P2
        required_for: ["wireless"]
        type: "text"
        keywords_cn: ["覆盖", "覆盖范围", "覆盖面积"]
        validation:
          message_cn: "建议明确覆盖范围要求"

  - group_id: security
    group_label_cn: "安全功能"
    items:
      - field_id: security.throughput
        label_cn: "安全吞吐量"
        priority: P1
        required_for: ["firewall"]
        type: "text"
        keywords_cn: ["安全吞吐量", "加密吞吐", "VPN吞吐"]
        validation:
          message_cn: "建议明确安全吞吐量"

      - field_id: security.vpn_support
        label_cn: "VPN支持"
        priority: P2
        required_for: ["firewall"]
        type: "text"
        keywords_cn: ["VPN", "IPSec", "SSL VPN", "VPN隧道"]
        validation:
          message_cn: "建议明确VPN支持要求"

      - field_id: security.feature
        label_cn: "安全功能"
        priority: P2
        required_for: ["firewall"]
        type: "text"
        keywords_cn: ["入侵检测", "IDS", "IPS", "防病毒", "应用控制"]
        validation:
          message_cn: "建议明确安全功能要求"

  - group_id: reliability
    group_label_cn: "可靠性"
    items:
      - field_id: reliability.redundancy
        label_cn: "冗余设计"
        priority: P2
        required_for: ["switch", "router", "firewall"]
        type: "text"
        keywords_cn: ["冗余", "热备", "堆叠", "双机", "电源冗余"]
        validation:
          message_cn: "建议明确冗余要求"

      - field_id: reliability.mtu
        label_cn: "MTU支持"
        priority: P2
        required_for: ["switch"]
        type: "integer"
        keywords_cn: ["MTU", "巨型帧", "Jumbo Frame"]
        validation:
          message_cn: "建议明确MTU要求"

  - group_id: management
    group_label_cn: "管理功能"
    items:
      - field_id: management.protocol
        label_cn: "管理协议"
        priority: P2
        required_for: ["all"]
        type: "text"
        keywords_cn: ["SNMP", "Web管理", "CLI", "Telnet", "SSH"]
        validation:
          message_cn: "建议明确管理方式"

  - group_id: acceptance_support
    group_label_cn: "验收与服务"
    items:
      - field_id: acceptance.criteria
        label_cn: "验收指标"
        priority: P0
        required_for: ["all"]
        type: "text"
        keywords_cn: ["验收", "测试", "性能测试"]
        validation:
          not_empty: true
          message_cn: "验收指标为必填项"

      - field_id: support.warranty
        label_cn: "质保服务"
        priority: P0
        required_for: ["all"]
        type: "text"
        keywords_cn: ["质保", "保修", "售后服务"]
        validation:
          not_empty: true
          message_cn: "质保服务为必填项"

risk_rules:
  - rule_id: risk.brand_directivity
    priority: P0
    description_cn: "检测到品牌指定"
    trigger_patterns:
      cn_keywords:
        - "华为交换机"
        - "华三"
        - "H3C"
        - "思科"
        - "Cisco"
        - "锐捷"
        - " Juniper"
    action:
      report_message_cn: "存在品牌指向性，建议删除品牌名称"

  - rule_id: risk.model_designation
    priority: P0
    description_cn: "检测到型号指定"
    trigger_patterns:
      regex:
        - "(?i)\\b(S\\d{4}|C\\d{4}|WS-\\w+|ISR\\d{4}|ASR\\d{4})\\b"
    action:
      report_message_cn: "检测到具体型号，建议改为性能参数描述"
